import tkinter as tk
from tkinter import messagebox
import mysql.connector
class catagorys:
    def __init__(self, category_name="", category_id=0):
        self.category_name=category_name
        self.category_id=category_id
        self.root=tk.Tk()
        self.root.title("catagory section")
        self.frame=tk.Frame(self.root,width=1000,height=1000)
        self.frame.pack()
        self.adding_catagory()
        self.root.mainloop()

    def adding_catagory(self):
        label=tk.Label(self.frame,text="pleas enter the catagory that you want to add")
        label.pack()
        self.add_box=tk.Entry(self.frame,width=50)
        self.add_box.pack()
        subment=tk.Button(self.frame,text="add the catagory",command=self.save_catagory)
        subment.pack()
    def save_catagory(self):
        self.category_name=self.add_box.get()
        if not self.category_name:
            messagebox.showwarning("","please enter the the catagory that you want to add")
            return
        messagebox.showinfo("","the catagory have been added succesfully")
    def update_category(self):

        label = tk.Label(self.frame, text="Enter the category ID to update")
        label.pack()

        self.catID = tk.Entry(self.frame, width=50)
        self.catID.pack()

        # Only one field exists (category_name), so no combo box needed
        next_btn = tk.Button(self.frame, text="Next", command=self.open_update_category_window)
        next_btn.pack()

    def open_update_category_window(self):
        category_id = self.catID.get()

        if category_id == "":
            messagebox.showerror("Error", "Please enter the ID")
            return

        # Create popup window
        self.c_window = tk.Toplevel(self.frame)
        self.c_window.title("Update Category")

        tk.Label(self.c_window, text="Enter new category name:").pack()

        self.newValue = tk.Entry(self.c_window, width=50)
        self.newValue.pack()

        tk.Button(self.c_window, text="Update", command=self.update).pack()

    def update(self):
        category_id = self.catID.get()
        new_value = self.newValue.get()

        if new_value == "":
            messagebox.showerror("Error", "Please enter the new value")
            return

        sql = "UPDATE categories SET category_name=%s WHERE category_id=%s"
        cursor.execute(sql, (new_value, category_id))
        db.commit()

        messagebox.showinfo("Success", "Successfully updated")
        self.c_window.destroy()

    def delete_category(self):
        label=tk.Label(self.frame,text="pleas enter the catagory that you want to remove")
        label.pack()
        self.add_box=tk.Entry(self.frame,width=50)
        self.add_box.pack()
        subment=tk.Button(self.frame,text="add the catagory",command=self.remove)
        subment.pack()
        def remove(self):
           sql = "DELETE FROM categories WHERE category_id=%s"
           cursor.execute(sql, (category_id,))
           db.commit()
           messagebox.showinfo("seccess","seccesfully added")
